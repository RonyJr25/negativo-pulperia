<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Los Amigos de Negativo</title>
<link rel="manifest" href="manifest.json">

<style>
:root{
  --color-primario:#007BFF;
  --color-secundario:#FF0000;
  --color-acento:#3399FF;
}
body{
  font-family: Arial, sans-serif;
  margin:0;padding:0;
  background:#f0f4f8;
}
h1,h2{text-align:center;color:var(--color-primario);}
.container{
  max-width:900px;margin:20px auto;padding:15px;
  background:#fff;border-radius:10px;
  box-shadow:0 0 15px rgba(0,0,0,0.2);
}
.tabs{display:flex;justify-content:space-around;margin-bottom:10px;flex-wrap:wrap;}
.tab{padding:10px 20px;background:var(--color-primario);color:#fff;border-radius:5px;cursor:pointer;margin:2px;}
.tab.active{background:var(--color-acento);}
.section{margin-bottom:20px;}
.section button{
  width:100%;padding:10px;background:var(--color-primario);
  color:#fff;border:none;border-radius:5px;text-align:left;cursor:pointer;margin-bottom:5px;
}
.products{display:none;padding:5px 10px;}
.products button{
  width:calc(50% - 10px);margin:5px;background:var(--color-acento);
  color:#fff;border:none;border-radius:5px;padding:10px;cursor:pointer;
}
ul{list-style:none;padding:0;}
li{padding:5px 0;}
input{padding:5px;width:calc(100% - 12px);margin-bottom:10px;}
button{cursor:pointer;}
button.pagado{background:var(--color-secundario);}
button.editar{background:#FFA500;margin-left:5px;}
span.cliente:hover{color:var(--color-acento);text-decoration:underline;}
#totalVenta,#totalFiado,#totalCompra,#totalDia,#totalFiados,#totalPersonas{
  font-weight:bold;font-size:18px;color:var(--color-primario);
}
/* Estilos para el buscador de clientes */
#buscarCliente{
  width:150px;
  padding:5px;
  margin-left:10px;
}
#buscarClienteBtn{
  padding:5px 8px;
  margin-left:3px;
  cursor:pointer;
}
.buscar-container{
  display:flex;
  justify-content:flex-end;
  align-items:center;
  margin-bottom:10px;
}
/* Bot칩n de configuraci칩n */
#configBtn{
  position:absolute;
  top:20px;
  right:30px;
  background:none;
  border:none;
  cursor:pointer;
  font-size:20px;
  color:var(--color-primario);
}
/* Modal de configuraci칩n */
#modalConfig{
  display:none;
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.5);
  justify-content:center;align-items:center;
}
#modalContent{
  background:#fff;padding:20px;border-radius:10px;
  max-height:80%;overflow:auto;width:80%;
}
#modalContent h3{text-align:center;color:var(--color-primario);}
#modalContent input{width:80px;margin-right:10px;}
#modalContent button{margin-top:10px;padding:5px 10px;}
#agregarProductoContainer{
  border-top:1px solid #ccc;
  margin-top:15px;
  padding-top:10px;
}
#agregarProductoContainer input, #agregarProductoContainer select{
  margin-right:5px;
}
</style>
</head>
<body>

<h1>Los Amigos de Negativo</h1>

<div class="container">
  <div class="tabs">
    <div class="tab active" onclick="showTab('dashboard')">Dashboard</div>
    <div class="tab" onclick="showTab('venta')">Calculadora</div>
    <div class="tab" onclick="showTab('fiado')">Fiado</div>
    <div class="tab" onclick="showTab('compra')">Compras</div>
  </div>

  <!-- BOT칍N DE CONFIGURACI칍N -->
  <button id="configBtn" onclick="abrirConfig()">丘뙖잺</button>

  <!-- DASHBOARD -->
  <div id="dashboard">
    <h2>Dashboard</h2>
    <p>Total de ventas del d칤a: L.<span id="totalDia">0</span></p>
    <p>Total fiados pendientes: L.<span id="totalFiados">0</span></p>
    <p>Total personas con deuda: <span id="totalPersonas">0</span></p>
  </div>

  <!-- VENTAS -->
  <div id="venta" style="display:none;">
    <h2>Calculadora de Ventas</h2>
    <div id="sectionsVenta"></div>
    <h3>Productos Seleccionados:</h3>
    <ul id="listaVenta"></ul>
    <h3>Total: L.<span id="totalVenta">0</span></h3>
    <button onclick="resetVenta()">Limpiar</button>
  </div>

  <!-- FIADO -->
  <div id="fiado" style="display:none;">
    <h2>Fiados</h2>
    <input type="text" id="cliente" placeholder="Nombre del cliente">
    <button onclick="agregarCliente()">Agregar Cliente</button>

    <!-- Buscador a la derecha con lupa -->
    <div class="buscar-container">
      <input type="text" id="buscarCliente" placeholder="Buscar cliente">
      <button id="buscarClienteBtn" onclick="actualizarListaClientes()">游댌</button>
    </div>

    <h3>Clientes y deuda:</h3>
    <ul id="listaClientes"></ul>
  </div>

  <!-- COMPRAS -->
  <div id="compra" style="display:none;">
    <h2>Calculadora de Compras</h2>
    <div id="sectionsCompra"></div>
    <ul id="listaCompra"></ul>
    <h3>Total: L.<span id="totalCompra">0</span></h3>
    <button onclick="resetCompra()">Limpiar</button>
  </div>
</div>

<!-- MODAL CONFIGURACI칍N -->
<div id="modalConfig">
  <div id="modalContent">
    <h3>Modificar precios de productos</h3>
    <div id="configProductos"></div>

    <!-- AGREGAR PRODUCTO -->
    <div id="agregarProductoContainer">
      <h4>Agregar nuevo producto</h4>
      <input type="text" id="nuevoNombre" placeholder="Nombre">
      <input type="number" id="nuevoPrecio" placeholder="Precio">
      <select id="nuevoCategoria">
        <option value="Cervezas">Cervezas</option>
        <option value="Churros">Churros</option>
        <option value="Bebidas">Bebidas</option>
        <option value="Otros">Otros</option>
        <option value="Paquetes">Paquetes</option>
      </select>
      <button onclick="agregarProducto()">Agregar</button>
    </div>

    <button onclick="cerrarConfig()">Cerrar</button>
  </div>
</div>

<script>
/* -------------------------------------------------------
   PRODUCTOS
--------------------------------------------------------*/
const productos = {
  "Cervezas":[
    { "nombre": "Salvavidas", "precio": 25 },
    { "nombre": "Barenas", "precio": 26 },
    { "nombre": "Miller", "precio": 27 },
    { "nombre": "Bud Light", "precio": 30 },
    { "nombre": "Corona", "precio": 40 },
    { "nombre": "Caguama", "precio": 40 },
    { "nombre": "Taconuda", "precio": 35 },
    { "nombre": "Taconuda Miller", "precio": 37 },
    { "nombre": "Ultra", "precio": 40 },
    { "nombre": "Ron de 20", "precio": 20 },
    { "nombre": "Ron de 40", "precio": 40 },
    { "nombre": "Gallo", "precio": 27 } // Nuevo producto
  ],
  "Churros":[
    { "nombre": "Doritos", "precio": 5 },
    { "nombre": "Chicharrones", "precio": 10 },
    { "nombre": "Zambos", "precio": 8 },
    { "nombre": "Rica Sula", "precio": 8 },
    { "nombre": "Yuquitas", "precio": 5 },
    { "nombre": "Zibas", "precio": 10 },
    { "nombre": "Taqueritos", "precio": 7 },
    { "nombre": "Capy", "precio": 7 },
    { "nombre": "Galletas", "precio": 17 },
    { "nombre": "Ranchitas", "precio": 7 },
    { "nombre": "Tacos", "precio": 5 },
    { "nombre": "Ranchitas Naturales", "precio": 10 },
    { "nombre": "Anillitos", "precio": 5 },
    { "nombre": "Gustitos", "precio": 4 },
    { "nombre": "Papasitas", "precio": 4 },
    { "nombre": "Quesitrix", "precio": 4 },
    { "nombre": "Piguis", "precio": 4 },
    { "nombre": "Elotitos", "precio": 5 },
    { "nombre": "Man칤", "precio": 5 },
    { "nombre": "Tostecas", "precio": 5 },
    { "nombre": "Nachos", "precio": 5 },
    { "nombre": "Jalape침os", "precio": 5 },
    { "nombre": "Fritos", "precio": 7 }
  ],
  "Bebidas":[
    { "nombre": "Fescos", "precio": 13 },
    { "nombre": "Frescos Personal", "precio": 25 },
    { "nombre": "Gatorade", "precio": 35 },
    { "nombre": "Agua de Bote", "precio": 20 },
    { "nombre": "Bolsa de Agua", "precio": 4 },
    { "nombre": "Marinero", "precio": 20 },
    { "nombre": "Jugos en Lata", "precio": 20 },
    { "nombre": "Bolt", "precio": 15 },
    { "nombre": "Jugos Peque침os", "precio": 10 },
    { "nombre": "Coca 1.1L", "precio": 35 },
    { "nombre": "Coca 1.5L", "precio": 40 },
    { "nombre": "Coca 2L", "precio": 53 },
    { "nombre": "Coca Jumbo", "precio": 70 }
  ],
  "Otros":[
    { "nombre": "Papel Higi칠nico", "precio": 20 },
    { "nombre": "Paquete de Cigarro", "precio": 35 },
    { "nombre": "Cigarro Menudeado", "precio": 3 },
    { "nombre": "Doble Click", "precio": 8 },
    { "nombre": "Pack Doble Click", "precio": 100 },
    { "nombre": "Naipe", "precio": 20 },
    { "nombre": "Chile", "precio": 40 },
    { "nombre": "Encendedor", "precio": 35 },
    { "nombre": "Super Blue", "precio": 10 },
    { "nombre": "Sopa Instant치nea", "precio": 17 }
  ],
  "Paquetes":[
    { "nombre":"Caja Salvavida", "precio":430 },
    { "nombre":"Caja Barena", "precio":450 },
    { "nombre":"Caja Miller", "precio":475 },
    { "nombre":"Caja Caguama Salva", "precio":360 },
    { "nombre":"Caja Caguama Barena", "precio":370 },
    { "nombre":"Paquete Guaro", "precio":700 },
    { "nombre":"Taconuda Salva", "precio":640 },
    { "nombre":"Taconuda Barena", "precio":660 },
    { "nombre":"Ultra", "precio":700 },
    { "nombre":"Corona", "precio":700 },
    { "nombre":"Budligth", "precio":480 },
    { "nombre":"Caja de Coca", "precio":245 }, // Nuevo producto
    { "nombre":"Caja de Pepsi", "precio":240 } // Nuevo producto
  ]
};

/* -----------------------------------------
   LOCALSTORAGE
------------------------------------------*/
function getClientes(){
  return JSON.parse(localStorage.getItem("clientes_negativo") || "{}");
}
function saveClientes(data){
  localStorage.setItem("clientes_negativo", JSON.stringify(data));
}

/* -----------------------------------------
   VENTAS
------------------------------------------*/
let totalVenta = 0;
const listaVenta = document.getElementById("listaVenta");

function agregarItem(nombre,precio,lista,tipo){
  const li=document.createElement("li");
  li.textContent=`${nombre} - L.${precio}`;
  lista.appendChild(li);

  if(tipo==="venta"){
    totalVenta+=precio;
    document.getElementById("totalVenta").textContent=totalVenta;
    actualizarDashboard();
  }
  if(tipo==="compra"){
    totalCompra+=precio;
    document.getElementById("totalCompra").textContent=totalCompra;
  }
}

function crearSecciones(id){
  const cont=document.getElementById(id);
  cont.innerHTML="";
  for(const cat in productos){
    if(cat==="Paquetes") continue;

    const btn=document.createElement("button");
    btn.textContent=cat;
    btn.onclick=()=>{ const div=btn.nextSibling; div.style.display=div.style.display==="none"?"block":"none"; };
    cont.appendChild(btn);

    const div=document.createElement("div");
    div.className="products";

    productos[cat].forEach(p=>{
      const b=document.createElement("button");
      b.textContent=`${p.nombre} - L.${p.precio}`;
      b.onclick=()=>agregarItem(p.nombre,p.precio,listaVenta,"venta");
      div.appendChild(b);
    });

    cont.appendChild(div);
  }
}

function resetVenta(){
  listaVenta.innerHTML="";
  totalVenta=0;
  document.getElementById("totalVenta").textContent=0;
  actualizarDashboard();
}

/* -----------------------------------------
   COMPRAS
------------------------------------------*/
let totalCompra=0;
const listaCompra=document.getElementById("listaCompra");

function crearSeccionesCompra(){
  const cont=document.getElementById("sectionsCompra");
  cont.innerHTML="";
  productos["Paquetes"].forEach(p=>{
    const btn=document.createElement("button");
    btn.textContent=`${p.nombre} - L.${p.precio}`;
    btn.onclick=()=>agregarItem(p.nombre,p.precio,listaCompra,"compra");
    cont.appendChild(btn);
  });
}

function resetCompra(){
  listaCompra.innerHTML="";
  totalCompra=0;
  document.getElementById("totalCompra").textContent=0;
}

/* -----------------------------------------
   FIADOS
------------------------------------------*/
let clientes=getClientes();
const listaClientes=document.getElementById("listaClientes");

function agregarCliente(){
  const nombre=document.getElementById("cliente").value.trim();
  if(!nombre) return alert("Ingrese un nombre");
  if(clientes[nombre]) return alert("Ese cliente ya existe");

  clientes[nombre]={ total:0, productos:[] };
  saveClientes(clientes);
  document.getElementById("cliente").value="";
  actualizarListaClientes();
}

function actualizarListaClientes(){
  listaClientes.innerHTML="";
  let totalFiado=0;
  let personas=0;
  const busqueda=document.getElementById("buscarCliente").value.toLowerCase();

  const nombresOrdenados=Object.keys(clientes).sort();
  nombresOrdenados.forEach(nombre=>{
    if(busqueda && !nombre.toLowerCase().includes(busqueda)) return;

    const data=clientes[nombre];
    totalFiado+=data.total;
    personas++;

    const li=document.createElement("li");
    li.style.marginBottom="15px";

    const span=document.createElement("span");
    span.textContent=`${nombre} - L.${data.total}`;
    span.className="cliente";

    const btnP=document.createElement("button");
    btnP.textContent="Pag칩";
    btnP.className="pagado";
    btnP.onclick=()=>{ delete clientes[nombre]; saveClientes(clientes); actualizarListaClientes(); };

    const btnE=document.createElement("button");
    btnE.textContent="Editar deuda";
    btnE.className="editar";
    btnE.onclick=()=>{ let p=prompt("Ingrese abono (positivo) o cargo (negativo):","0"); if(p!==null){ p=parseFloat(p); if(!isNaN(p)){ let nuevo=data.total-p; if(nuevo<0) nuevo=0; data.total=nuevo; saveClientes(clientes); actualizarListaClientes(); } } };

    li.appendChild(span);
    li.appendChild(btnP);
    li.appendChild(btnE);

    const divDetalle=document.createElement("div");
    divDetalle.style.display="none";
    divDetalle.style.marginLeft="15px";
    const listaProd=document.createElement("ul");
    data.productos.forEach(p=>{
      const item=document.createElement("li");
      item.textContent=`${p.nombre} - L.${p.precio}`;
      listaProd.appendChild(item);
    });
    divDetalle.appendChild(listaProd);

    const totalTxt=document.createElement("p");
    totalTxt.style.fontWeight="bold";
    totalTxt.textContent="Total del cliente: L." + data.total;
    divDetalle.appendChild(totalTxt);

    ["Cervezas","Churros","Bebidas","Otros"].forEach(cat=>{
      const btn=document.createElement("button");
      btn.textContent=cat;
      btn.onclick=()=>{ const d=btn.nextSibling; d.style.display=d.style.display==="none"?"block":"none"; };
      divDetalle.appendChild(btn);

      const div=document.createElement("div");
      div.className="products";
      productos[cat].forEach(p=>{
        const b=document.createElement("button");
        b.textContent=`${p.nombre} - L.${p.precio}`;
        b.onclick=()=>{ data.total+=p.precio; data.productos.push({nombre:p.nombre,precio:p.precio}); saveClientes(clientes); actualizarListaClientes(); };
        div.appendChild(b);
      });
      divDetalle.appendChild(div);
    });

    li.appendChild(divDetalle);
    span.onclick=()=>{ divDetalle.style.display=divDetalle.style.display==="none"?"block":"none"; };
    listaClientes.appendChild(li);
  });

  document.getElementById("totalFiados").textContent=totalFiado;
  document.getElementById("totalPersonas").textContent=personas;
}

/* -----------------------------------------
   DASHBOARD
------------------------------------------*/
function actualizarDashboard(){
  document.getElementById("totalDia").textContent=totalVenta;
  let totalFiado=0;
  let personas=0;
  for(const n in clientes){ totalFiado+=clientes[n].total; personas++; }
  document.getElementById("totalFiados").textContent=totalFiado;
  document.getElementById("totalPersonas").textContent=personas;
}

/* -----------------------------------------
   TABS
------------------------------------------*/
function showTab(tab){
  ["dashboard","venta","fiado","compra"].forEach(t=>{ document.getElementById(t).style.display="none"; });
  document.getElementById(tab).style.display="block";
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  document.querySelector(`.tab[onclick="showTab('${tab}')"]`).classList.add("active");
}

/* -----------------------------------------
   CONFIGURACI칍N DE PRECIOS Y NUEVOS PRODUCTOS
------------------------------------------*/
function abrirConfig(){
  const modal=document.getElementById("modalConfig");
  const cont=document.getElementById("configProductos");
  cont.innerHTML="";
  for(const cat in productos){
    const h4=document.createElement("h4");
    h4.textContent=cat;
    cont.appendChild(h4);

    productos[cat].forEach((p,index)=>{
      const div=document.createElement("div");
      div.style.marginBottom="5px";
      div.innerHTML=`${p.nombre}: L.<input type="number" value="${p.precio}" id="precio_${cat}_${index}"> <button onclick="guardarPrecio('${cat}',${index})">Guardar</button>`;
      cont.appendChild(div);
    });
  }
  modal.style.display="flex";
}

function cerrarConfig(){ document.getElementById("modalConfig").style.display="none"; }

function guardarPrecio(cat,index){
  const input=document.getElementById(`precio_${cat}_${index}`);
  const nuevo=parseFloat(input.value);
  if(!isNaN(nuevo)){
    productos[cat][index].precio=nuevo;
    alert("Precio actualizado");
    crearSecciones("sectionsVenta");
    crearSeccionesCompra();
    actualizarListaClientes();
    actualizarDashboard();
  }
}

function agregarProducto(){
  const nombre=document.getElementById("nuevoNombre").value.trim();
  const precio=parseFloat(document.getElementById("nuevoPrecio").value);
  const categoria=document.getElementById("nuevoCategoria").value;
  if(!nombre || isNaN(precio)) return alert("Ingrese nombre y precio v치lido");

  productos[categoria].push({nombre, precio});
  alert("Producto agregado");
  document.getElementById("nuevoNombre").value="";
  document.getElementById("nuevoPrecio").value="";
  crearSecciones("sectionsVenta");
  crearSeccionesCompra();
  abrirConfig();
}

/* -----------------------------------------
   INIT
------------------------------------------*/
crearSecciones("sectionsVenta");
crearSeccionesCompra();
actualizarListaClientes();
actualizarDashboard();
</script>
</body>
</html>





